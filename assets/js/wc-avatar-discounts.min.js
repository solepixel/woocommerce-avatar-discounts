var WoocommerceAvatarDiscounts;(WoocommerceAvatarDiscounts=window.WoocommerceAvatarDiscounts||{}).Manage=function(t){"use strict";function e(){t(n).removeClass("expanded")}var n=".wc-ad-manage-avatars",a=function(){t(n+" a").off("click").on("click",function(a){a.preventDefault();var e=t(this).attr("data-avatar-id");if(!o())return t(this).blur(),void r();s(e)})},o=function(){return!!t("body").hasClass("wp-admin")||t(n).hasClass("expanded")},r=function(){t(n).addClass("expanded")},s=function(a){t('input[name="woocommerce_avatar_discounts_avatar"]').val(a),c(),t(n+' a[data-avatar-id="'+a+'"]').addClass("status-featured").blur(),e()},c=function(){t(n+" a.status-featured").removeClass("status-featured")};return{init:function(){a()},clearFeatured:c,collapseAvatars:e,bindAvatars:a}}(jQuery),jQuery(window).on("load",WoocommerceAvatarDiscounts.Manage.init),(WoocommerceAvatarDiscounts=window.WoocommerceAvatarDiscounts||{}).Upload=function(r){"use strict";var a=function(){r(".wc-ad-upload").on("change",function(){var e=r(this);r(".wc-ad-file-display").html(function(a){if(a){var e=0<=a.indexOf("\\")?a.lastIndexOf("\\"):a.lastIndexOf("/"),t=a.substring(e);return 0!==t.indexOf("\\")&&0!==t.indexOf("/")||(t=t.substring(1)),t}}(e.val()));var a=e.attr("name"),t=e.prop("files")[0],n=new FormData,o=r('input[name="woocommerce_avatar_discounts_user"]').val();n.append(a,t),n.append("user_id",o),s(),r.ajax({url:wcad_vars.ajax_url+"?action=wcad_ajax_file_upload",dataType:"text",cache:!1,contentType:!1,processData:!1,type:"post",data:n,success:function(a){a=JSON.parse(a),r(".wc-ad-file-display").html(""),e.val(),a.success?(WoocommerceAvatarDiscounts.Manage.clearFeatured(),r(".wc-ad-avatar-selection").append(a.html),WoocommerceAvatarDiscounts.Manage.bindAvatars(),WoocommerceAvatarDiscounts.Manage.collapseAvatars()):alert(a.error),c()}})})},s=function(){var a=r(".wcad-loader");if(!a.length){a=r("<div />").addClass("wcad-loader");var e=r("<span />").addClass("spinner");a.append(e),r(".wc-ad-manage-avatars").prepend(a)}a.addClass("active")},c=function(){r(".wcad-loader").removeClass("active")};return{init:function(){a()}}}(jQuery),jQuery(window).on("load",WoocommerceAvatarDiscounts.Upload.init);